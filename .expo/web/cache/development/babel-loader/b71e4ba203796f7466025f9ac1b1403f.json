{"ast":null,"code":"import { cond, sub, divide, multiply, sqrt, add, block, set, exp, sin, cos, eq, or, neq, and, lessThan, greaterThan, proc, min, abs } from \"../base\";\nimport AnimatedValue from \"../core/InternalAnimatedValue\";\nvar MAX_STEPS_MS = 64;\nfunction spring(clock, state, config) {\n  var lastTime = cond(state.time, state.time, clock);\n  var deltaTime = min(sub(clock, lastTime), MAX_STEPS_MS);\n  var c = config.damping;\n  var m = config.mass;\n  var k = config.stiffness;\n  var v0 = multiply(-1, state.velocity);\n  var x0 = sub(config.toValue, state.position);\n  var zeta = divide(c, multiply(2, sqrt(multiply(k, m))));\n  var omega0 = sqrt(divide(k, m));\n  var omega1 = multiply(omega0, sqrt(sub(1, multiply(zeta, zeta))));\n  var t = divide(deltaTime, 1000);\n  var sin1 = sin(multiply(omega1, t));\n  var cos1 = cos(multiply(omega1, t));\n  var underDampedEnvelope = exp(multiply(-1, zeta, omega0, t));\n  var underDampedFrag1 = multiply(underDampedEnvelope, add(multiply(sin1, divide(add(v0, multiply(zeta, omega0, x0)), omega1)), multiply(x0, cos1)));\n  var underDampedPosition = sub(config.toValue, underDampedFrag1);\n  var underDampedVelocity = sub(multiply(zeta, omega0, underDampedFrag1), multiply(underDampedEnvelope, sub(multiply(cos1, add(v0, multiply(zeta, omega0, x0))), multiply(omega1, x0, sin1))));\n  var criticallyDampedEnvelope = exp(multiply(-1, omega0, t));\n  var criticallyDampedPosition = sub(config.toValue, multiply(criticallyDampedEnvelope, add(x0, multiply(add(v0, multiply(omega0, x0)), t))));\n  var criticallyDampedVelocity = multiply(criticallyDampedEnvelope, add(multiply(v0, sub(multiply(t, omega0), 1)), multiply(t, x0, omega0, omega0)));\n  var prevPosition = state.prevPosition ? state.prevPosition : new AnimatedValue(0);\n  var isOvershooting = cond(and(config.overshootClamping, neq(config.stiffness, 0)), cond(lessThan(prevPosition, config.toValue), greaterThan(state.position, config.toValue), lessThan(state.position, config.toValue)));\n  var isVelocity = lessThan(abs(state.velocity), config.restSpeedThreshold);\n  var isDisplacement = or(eq(config.stiffness, 0), lessThan(abs(sub(config.toValue, state.position)), config.restDisplacementThreshold));\n  return block([set(prevPosition, state.position), cond(lessThan(zeta, 1), [set(state.position, underDampedPosition), set(state.velocity, underDampedVelocity)], [set(state.position, criticallyDampedPosition), set(state.velocity, criticallyDampedVelocity)]), set(state.time, clock), cond(or(isOvershooting, and(isVelocity, isDisplacement)), [cond(neq(config.stiffness, 0), [set(state.velocity, 0), set(state.position, config.toValue)]), set(state.finished, 1)])]);\n}\nvar procSpring = proc(function (finished, velocity, position, time, prevPosition, toValue, damping, mass, stiffness, overshootClamping, restSpeedThreshold, restDisplacementThreshold, clock) {\n  return spring(clock, {\n    finished: finished,\n    velocity: velocity,\n    position: position,\n    time: time,\n    prevPosition: prevPosition\n  }, {\n    toValue: toValue,\n    damping: damping,\n    mass: mass,\n    stiffness: stiffness,\n    overshootClamping: overshootClamping,\n    restDisplacementThreshold: restDisplacementThreshold,\n    restSpeedThreshold: restSpeedThreshold\n  });\n});\nexport default function springAnimation(clock, _ref, _ref2) {\n  var finished = _ref.finished,\n    velocity = _ref.velocity,\n    position = _ref.position,\n    time = _ref.time,\n    prevPosition = _ref.prevPosition;\n  var toValue = _ref2.toValue,\n    damping = _ref2.damping,\n    mass = _ref2.mass,\n    stiffness = _ref2.stiffness,\n    overshootClamping = _ref2.overshootClamping,\n    restDisplacementThreshold = _ref2.restDisplacementThreshold,\n    restSpeedThreshold = _ref2.restSpeedThreshold;\n  return procSpring(finished, velocity, position, time, prevPosition, toValue, damping, mass, stiffness, overshootClamping, restSpeedThreshold, restDisplacementThreshold, clock);\n}","map":{"version":3,"names":["cond","sub","divide","multiply","sqrt","add","block","set","exp","sin","cos","eq","or","neq","and","lessThan","greaterThan","proc","min","abs","AnimatedValue","MAX_STEPS_MS","spring","clock","state","config","lastTime","time","deltaTime","c","damping","m","mass","k","stiffness","v0","velocity","x0","toValue","position","zeta","omega0","omega1","t","sin1","cos1","underDampedEnvelope","underDampedFrag1","underDampedPosition","underDampedVelocity","criticallyDampedEnvelope","criticallyDampedPosition","criticallyDampedVelocity","prevPosition","isOvershooting","overshootClamping","isVelocity","restSpeedThreshold","isDisplacement","restDisplacementThreshold","finished","procSpring","springAnimation"],"sources":["/Users/jeko/Documents/Reactive-4twiggers-animation/node_modules/react-native-reanimated/lib/reanimated1/animations/spring.js"],"sourcesContent":["import {\n  cond,\n  sub,\n  divide,\n  multiply,\n  sqrt,\n  add,\n  block,\n  set,\n  exp,\n  sin,\n  cos,\n  eq,\n  or,\n  neq,\n  and,\n  lessThan,\n  greaterThan,\n  proc,\n  min,\n  abs,\n} from '../base';\nimport AnimatedValue from '../core/InternalAnimatedValue';\n\nconst MAX_STEPS_MS = 64;\n\nfunction spring(clock, state, config) {\n  const lastTime = cond(state.time, state.time, clock);\n\n  const deltaTime = min(sub(clock, lastTime), MAX_STEPS_MS);\n\n  const c = config.damping;\n  const m = config.mass;\n  const k = config.stiffness;\n\n  const v0 = multiply(-1, state.velocity);\n  const x0 = sub(config.toValue, state.position);\n\n  const zeta = divide(c, multiply(2, sqrt(multiply(k, m)))); // damping ratio\n  const omega0 = sqrt(divide(k, m)); // undamped angular frequency of the oscillator (rad/ms)\n  const omega1 = multiply(omega0, sqrt(sub(1, multiply(zeta, zeta)))); // exponential decay\n\n  const t = divide(deltaTime, 1000); // in seconds\n\n  const sin1 = sin(multiply(omega1, t));\n  const cos1 = cos(multiply(omega1, t));\n\n  // under damped\n  const underDampedEnvelope = exp(multiply(-1, zeta, omega0, t));\n  const underDampedFrag1 = multiply(\n    underDampedEnvelope,\n    add(\n      multiply(sin1, divide(add(v0, multiply(zeta, omega0, x0)), omega1)),\n      multiply(x0, cos1)\n    )\n  );\n  const underDampedPosition = sub(config.toValue, underDampedFrag1);\n  // This looks crazy -- it's actually just the derivative of the oscillation function\n  const underDampedVelocity = sub(\n    multiply(zeta, omega0, underDampedFrag1),\n    multiply(\n      underDampedEnvelope,\n      sub(\n        multiply(cos1, add(v0, multiply(zeta, omega0, x0))),\n        multiply(omega1, x0, sin1)\n      )\n    )\n  );\n\n  // critically damped\n  const criticallyDampedEnvelope = exp(multiply(-1, omega0, t));\n  const criticallyDampedPosition = sub(\n    config.toValue,\n    multiply(\n      criticallyDampedEnvelope,\n      add(x0, multiply(add(v0, multiply(omega0, x0)), t))\n    )\n  );\n  const criticallyDampedVelocity = multiply(\n    criticallyDampedEnvelope,\n    add(\n      multiply(v0, sub(multiply(t, omega0), 1)),\n      multiply(t, x0, omega0, omega0)\n    )\n  );\n\n  // conditions for stopping the spring animations\n  const prevPosition = state.prevPosition\n    ? state.prevPosition\n    : new AnimatedValue(0);\n\n  const isOvershooting = cond(\n    and(config.overshootClamping, neq(config.stiffness, 0)),\n    cond(\n      lessThan(prevPosition, config.toValue),\n      greaterThan(state.position, config.toValue),\n      lessThan(state.position, config.toValue)\n    )\n  );\n  const isVelocity = lessThan(abs(state.velocity), config.restSpeedThreshold);\n  const isDisplacement = or(\n    eq(config.stiffness, 0),\n    lessThan(\n      abs(sub(config.toValue, state.position)),\n      config.restDisplacementThreshold\n    )\n  );\n\n  return block([\n    set(prevPosition, state.position),\n    cond(\n      lessThan(zeta, 1),\n      [\n        set(state.position, underDampedPosition),\n        set(state.velocity, underDampedVelocity),\n      ],\n      [\n        set(state.position, criticallyDampedPosition),\n        set(state.velocity, criticallyDampedVelocity),\n      ]\n    ),\n    set(state.time, clock),\n    cond(or(isOvershooting, and(isVelocity, isDisplacement)), [\n      cond(neq(config.stiffness, 0), [\n        set(state.velocity, 0),\n        set(state.position, config.toValue),\n      ]),\n      set(state.finished, 1),\n    ]),\n  ]);\n}\n\nconst procSpring = proc(\n  (\n    finished,\n    velocity,\n    position,\n    time,\n    prevPosition,\n    toValue,\n    damping,\n    mass,\n    stiffness,\n    overshootClamping,\n    restSpeedThreshold,\n    restDisplacementThreshold,\n    clock\n  ) =>\n    spring(\n      clock,\n      {\n        finished,\n        velocity,\n        position,\n        time,\n        prevPosition,\n      },\n      {\n        toValue,\n        damping,\n        mass,\n        stiffness,\n        overshootClamping,\n        restDisplacementThreshold,\n        restSpeedThreshold,\n      }\n    )\n);\n\nexport default function springAnimation(\n  clock,\n  { finished, velocity, position, time, prevPosition },\n  {\n    toValue,\n    damping,\n    mass,\n    stiffness,\n    overshootClamping,\n    restDisplacementThreshold,\n    restSpeedThreshold,\n  }\n) {\n  return procSpring(\n    finished,\n    velocity,\n    position,\n    time,\n    prevPosition,\n    toValue,\n    damping,\n    mass,\n    stiffness,\n    overshootClamping,\n    restSpeedThreshold,\n    restDisplacementThreshold,\n    clock\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}